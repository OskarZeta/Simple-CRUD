(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{281:function(e,a,t){__NEXT_REGISTER_PAGE("/books",function(){return e.exports=t(297),{page:e.exports.default}})},297:function(e,a,t){"use strict";t.r(a);var c=t(0),s=t.n(c),n=t(31),r=t(32),l=t(6),o=t.n(l),m=t(3),_=t(4),h=t(1),d=t(21),i=t(46),u=t(47),E=t(2),x=Object(m.compose)(m.withApollo,Object(m.graphql)(_.d,{name:"getAuthorsQuery"}),Object(m.graphql)(_.f,{name:"getGenresQuery"}),Object(m.graphql)(_.e,{name:"getBooksQuery"}),Object(m.graphql)(_.b,{name:"addBookQuery",options:{refetchQueries:[{query:_.e}]}}),Object(m.graphql)(_.k,{name:"updateBookQuery",options:{refetchQueries:[{query:_.e}]}}))(Object(i.a)(Object(m.withApollo)(function(e){var a=e.selectHandler,t=(e.clickHandler,e.changeHandler),c=e.submitHandler,n=e.mapFromCache,r=e.mapOptions,l=e.wrapProps,h=e.client,d=e.formType,i=Array.from(l.genreIds),x=l.authorId;return s.a.createElement("div",{className:"jsx-".concat(E.a.__hash)},s.a.createElement("section",{className:"jsx-".concat(E.a.__hash)+" form-add"},s.a.createElement("label",{className:"jsx-".concat(E.a.__hash)+" form-add__label"},s.a.createElement("span",{className:"jsx-".concat(E.a.__hash)+" form-add__name"},"Name"),s.a.createElement("input",{name:"name",type:"text",placeholder:"enter name",value:l.name,onChange:function(e){t(e)},className:"jsx-".concat(E.a.__hash)+" form-add__input"})),s.a.createElement("label",{className:"jsx-".concat(E.a.__hash)+" form-add__label"},s.a.createElement("span",{className:"jsx-".concat(E.a.__hash)+" form-add__name"},"Author"),s.a.createElement("select",{onChange:function(e){a(e,"author")},className:"jsx-".concat(E.a.__hash)+" form-add__input"},s.a.createElement(m.Query,{query:_.d},function(e){var a=e.loading,t=(e.error,e.data);return a?s.a.createElement("option",{disabled:!0,className:"jsx-".concat(E.a.__hash)},"Loading authors..."):r(t.authors,x.split())})),s.a.createElement(u.a,{href:"/authors"})),n(x.split(),h,"author",E.a),s.a.createElement("label",{className:"jsx-".concat(E.a.__hash)+" form-add__label"},s.a.createElement("span",{className:"jsx-".concat(E.a.__hash)+" form-add__name"},"Related genres"),s.a.createElement("select",{onChange:function(e){a(e,"genres")},className:"jsx-".concat(E.a.__hash)+" form-add__input"},s.a.createElement(m.Query,{query:_.f},function(e){var a=e.loading,t=(e.error,e.data);return a?s.a.createElement("option",{disabled:!0,className:"jsx-".concat(E.a.__hash)},"Loading genres..."):r(t.genres,i)})),s.a.createElement(u.a,{href:"/genres"})),n(i,h,"genres",E.a),s.a.createElement("label",{className:"jsx-".concat(E.a.__hash)+" form-add__label"},s.a.createElement("span",{className:"jsx-".concat(E.a.__hash)+" form-add__name"},"Description"),s.a.createElement("textarea",{name:"description",placeholder:"enter description",value:l.description,onChange:function(e){t(e)},className:"jsx-".concat(E.a.__hash)+" form-add__input"})),s.a.createElement("div",{className:"jsx-".concat(E.a.__hash)+" form-add__btns"},s.a.createElement("button",{onClick:function(e){c(e)},className:"jsx-".concat(E.a.__hash)+" form-add__submit"},"edit-book"===d?"Save changes":"Create book"),s.a.createElement("button",{className:"jsx-".concat(E.a.__hash)+" form-add__close"},"Close"))),s.a.createElement(o.a,{styleId:E.a.__hash,css:E.a}))}))),j=t(17),b=function(e){var a=e.id;return s.a.createElement("div",{className:"jsx-".concat(h.a.__hash)+" table__wrapper table__wrapper--edit"},s.a.createElement(m.Query,{query:_.e},function(e){var t=e.loading,c=e.error,n=e.data;if(t)return s.a.createElement("div",{className:"jsx-".concat(h.a.__hash)},"Loading books...");if(c)return s.a.createElement("div",{className:"jsx-".concat(h.a.__hash)},"Error! $",c.message);var r=n.books.find(function(e){return e.id===a});return s.a.createElement("table",{className:"jsx-".concat(h.a.__hash)+" table"},s.a.createElement("tbody",{className:"jsx-".concat(h.a.__hash)},s.a.createElement("tr",{className:"jsx-".concat(h.a.__hash)},s.a.createElement("th",{className:"jsx-".concat(h.a.__hash)+" table__cell"},"Book name"),s.a.createElement("th",{className:"jsx-".concat(h.a.__hash)+" table__cell"},"Author name"),s.a.createElement("th",{className:"jsx-".concat(h.a.__hash)+" table__cell"},"Genres")),0===r.length?s.a.createElement(j.a,{name:"books",size:"3"}):s.a.createElement("tr",{key:r.id,className:"jsx-".concat(h.a.__hash)+" table__content"},s.a.createElement("td",{className:"jsx-".concat(h.a.__hash)+" table__cell"},r.name),s.a.createElement("td",{className:"jsx-".concat(h.a.__hash)+" table__cell"},r.author.name),0===r.genres.length?s.a.createElement("td",{className:"jsx-".concat(h.a.__hash)},"no genres"):s.a.createElement("td",{className:"jsx-".concat(h.a.__hash)+" table__cell"},s.a.createElement("table",{className:"jsx-".concat(h.a.__hash)},s.a.createElement("tbody",{className:"jsx-".concat(h.a.__hash)},r.genres.map(function(e){return s.a.createElement("tr",{key:e.id,className:"jsx-".concat(h.a.__hash)},s.a.createElement("td",{className:"jsx-".concat(h.a.__hash)},e.name))})))))))}),s.a.createElement(o.a,{styleId:h.a.__hash,css:h.a}))},p=t(48),N=Object(m.graphql)(_.h,{name:"removeBookQuery",options:{refetchQueries:[{query:_.e}]}})(Object(p.a)(function(e){var a=e.deleteHandler;return s.a.createElement("div",{className:"jsx-".concat(h.a.__hash)+" table__wrapper"},s.a.createElement("h2",{className:"jsx-".concat(h.a.__hash)+" table__name"},"Books"),s.a.createElement(d.a,{trigger:s.a.createElement("button",{className:"jsx-".concat(h.a.__hash)+" table__add"},"Add book")},s.a.createElement("div",{className:"jsx-".concat(h.a.__hash)},s.a.createElement(x,{formType:"add-book",defaultState:{name:"",authorId:"",genreIds:new Set,description:""}}))),s.a.createElement(m.Query,{query:_.e,fetchPolicy:"network-only"},function(e){var t=e.loading,c=e.error,n=e.data;if(t)return s.a.createElement("div",{className:"jsx-".concat(h.a.__hash)},"Loading books...");if(c)return s.a.createElement("div",{className:"jsx-".concat(h.a.__hash)},"Error! $",c.message);var r=n.books;return s.a.createElement("table",{className:"jsx-".concat(h.a.__hash)+" table"},s.a.createElement("tbody",{className:"jsx-".concat(h.a.__hash)},s.a.createElement("tr",{className:"jsx-".concat(h.a.__hash)},s.a.createElement("th",{className:"jsx-".concat(h.a.__hash)+" table__cell"},"Book name"),s.a.createElement("th",{className:"jsx-".concat(h.a.__hash)+" table__cell"},"Author name"),s.a.createElement("th",{className:"jsx-".concat(h.a.__hash)+" table__cell"},"Genres"),s.a.createElement("th",{className:"jsx-".concat(h.a.__hash)+" table__cell"},"Actions")),0===r.length?s.a.createElement(j.a,{name:"books",size:"4"}):r.map(function(e){return s.a.createElement("tr",{key:e.id,className:"jsx-".concat(h.a.__hash)+" table__content"},s.a.createElement("td",{className:"jsx-".concat(h.a.__hash)+" table__cell"},e.name),s.a.createElement("td",{className:"jsx-".concat(h.a.__hash)+" table__cell"},e.author.name),0===e.genres.length?s.a.createElement("td",{className:"jsx-".concat(h.a.__hash)},"no genres"):s.a.createElement("td",{className:"jsx-".concat(h.a.__hash)+" table__cell"},s.a.createElement("table",{className:"jsx-".concat(h.a.__hash)},s.a.createElement("tbody",{className:"jsx-".concat(h.a.__hash)},e.genres.map(function(e){return s.a.createElement("tr",{key:e.id,className:"jsx-".concat(h.a.__hash)},s.a.createElement("td",{className:"jsx-".concat(h.a.__hash)},e.name))})))),s.a.createElement("td",{className:"jsx-".concat(h.a.__hash)+" table__cell"},s.a.createElement(d.a,{trigger:s.a.createElement("button",{className:"jsx-".concat(h.a.__hash)+" table__edit"},"Edit")},s.a.createElement("div",{className:"jsx-".concat(h.a.__hash)},s.a.createElement(b,{id:e.id}),s.a.createElement(x,{formType:"edit-book",defaultState:{id:e.id,name:e.name,authorId:e.author.id,genreIds:new Set(e.genres.map(function(e){return e.id})),description:e.description}}))),s.a.createElement("button",{onClick:function(t,c){a(e.id,"removeBookQuery")},className:"jsx-".concat(h.a.__hash)+" table__delete"},s.a.createElement("span",{className:"jsx-".concat(h.a.__hash)},"Delete"))))})))}),s.a.createElement(o.a,{styleId:h.a.__hash,css:h.a}))})),f=t(33);a.default=Object(r.a)(function(){return s.a.createElement(f.a,{title:"Books table"},s.a.createElement(n.a,{id:"2"}),s.a.createElement(N,null))})},47:function(e,a,t){"use strict";var c=t(6),s=t.n(c),n=t(0),r=t.n(n),l=t(25),o=t.n(l);a.a=function(e){var a=e.href;return r.a.createElement(o.a,{href:a},r.a.createElement("a",{className:"jsx-3715969836 link"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"20px",height:"20px",viewBox:"0 0 456.795 456.795",className:"jsx-3715969836"},r.a.createElement("g",{className:"jsx-3715969836"},r.a.createElement("path",{d:"M448.947,218.475c-0.922-1.168-23.055-28.933-61-56.81c-50.705-37.253-105.877-56.944-159.551-56.944\r c-53.672,0-108.844,19.691-159.551,56.944c-37.944,27.876-60.077,55.642-61,56.81L0,228.397l7.846,9.923\r c0.923,1.168,23.056,28.934,61,56.811c50.707,37.252,105.879,56.943,159.551,56.943c53.673,0,108.845-19.691,159.55-56.943\r c37.945-27.877,60.078-55.643,61-56.811l7.848-9.923L448.947,218.475z M228.396,315.039c-47.774,0-86.642-38.867-86.642-86.642\r c0-7.485,0.954-14.751,2.747-21.684l-19.781-3.329c-1.938,8.025-2.966,16.401-2.966,25.013c0,30.86,13.182,58.696,34.204,78.187\r c-27.061-9.996-50.072-24.023-67.439-36.709c-21.516-15.715-37.641-31.609-46.834-41.478c9.197-9.872,25.32-25.764,46.834-41.478\r c17.367-12.686,40.379-26.713,67.439-36.71l13.27,14.958c15.498-14.512,36.312-23.412,59.168-23.412\r c47.774,0,86.641,38.867,86.641,86.642C315.037,276.172,276.17,315.039,228.396,315.039z M368.273,269.875\r c-17.369,12.686-40.379,26.713-67.439,36.709c21.021-19.49,34.203-47.326,34.203-78.188s-13.182-58.697-34.203-78.188\r c27.061,9.997,50.07,24.024,67.439,36.71c21.516,15.715,37.641,31.609,46.834,41.477\r C405.91,238.269,389.787,254.162,368.273,269.875z",className:"jsx-3715969836"}),r.a.createElement("path",{d:"M173.261,211.555c-1.626,5.329-2.507,10.982-2.507,16.843c0,31.834,25.807,57.642,57.642,57.642\r c31.834,0,57.641-25.807,57.641-57.642s-25.807-57.642-57.641-57.642c-15.506,0-29.571,6.134-39.932,16.094l28.432,32.048\r L173.261,211.555z",className:"jsx-3715969836"}))),r.a.createElement(s.a,{styleId:"3715969836",css:[".link.jsx-3715969836{margin-left:10px;}"]})))}}},[[281,1,0]]]);